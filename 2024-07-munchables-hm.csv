
issue,title,primary finding,validator comment,status,root cause (URL),size
validation-50,dirty flag of toilerState will not reset,findings-12,see validation-188,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L251,20
findings-66,Landlords' ability to pet munchables can be DoSed,findings-33,Temperary DoS,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L299-L300,23
validation-280,The transferToUnoccupiedPlot function does not update the toilerState variable correctly,validation-117, toilerState[tokenId].plotId not updated,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,24
validation-388,stakeMunchable and transferToUnoccupiedPlot functions frontrunning can cause significant tax rate increases,validation-216,"the situaltion is existing, but i think the severity is QA, as users can easily unstake munchNFT if the landlord is malicious. Mark Satisfactory per c4 validation rule.",Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L166,26
validation-340,External call to updatePlayer() will fail causing most operations to fail,validation-340,"The issue looks valid but triggered by OOS contract, mark Satisfactory for visibility",Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L309,27
validation-119,"Landlords can change the tax rate just before the user stakes their tokens, altering the expected terms.",validation-216,see validation-388,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L166,28
validation-14,Malicious landlords can frontrun the call to `stakeMunchable` and increase their `currentTaxRate`,validation-216,see validation-388,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L166,28
validation-394,unstakeMunchable function removes the old plot from the plotOccupied after transferToUnoccupiedPlot call ,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,30
validation-162,Landlord could loose on potential gains and make them rent unworthy and lose money,validation-233,DoS hurts both attacker and landlord,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L40,30
validation-298,An attacker can prevent a victim from transferring their staked MunchNFT to another plot,validation-225,"QA at most, as users could call AccountManager.register() to change back mainAccount to themself. Mark Satisfactory per c4 validation rule.",Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L208,31
validation-268,_farmPlots() doesn't check dirty bool for all plotId due to missing `=` check,validation-131,The = case is not valid plot,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L258,31
validation-177,"The `triggerPlotMetadata` function is prone to back-running attack, which can force the landlord to use an undesired tax rate",findings-48,the situation has a chance to occur,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L104-L114,31
validation-68,Incomplete update for `toilerState[tokenId]` to reflect plot transfer,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,31
findings-75,Farmers can grief landlords by staking and not farming,validation-233,see validation-162,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L40,31
validation-389,Blacklisted munchNFT staked in LandManager.sol continues earning rewards,findings-35,the situation of blacklisted NFTs is not processed in LandManager,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L11,32
validation-384,transferToUnoccupiedPlot function lacks toiler state change for the new associated plotId,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,32
validation-113,Users can occupy plots but not receive Schnibbles,validation-233,see validation-162,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L40,32
validation-99,Changing global parameters will alter all unclaimed rewards,validation-99,"the global parameters could be changed during upgrade, chance is low, QA is more suitable",Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L270,34
validation-86,"When the plot is dirty, the last update time is used for settlement.",validation-88,"usage of last update time is not correct, should force farm for all related NFTs if a landlord changes locking value",Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L258-L261,34
validation-342,Users might receive less rewards/schnibbles if they decide to `transferToUnoccupiedPlot()` their `Munchable/s`,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,35
validation-238,Transferring a tokenId to an unoccupied plot doesn't make its dirty state set to false,validation-108,the dirty flag should be set to false here,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L213,35
validation-222,"User could proceed to accrue rewards even if toiler gets ""dirty"".",validation-88,see validation-86,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L258-L261,36
validation-165,Some users would not be able to stake munchables,validation-231,"mismatch with doc? looks invalid, mark Satisfactory for visibility",Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L140,36
validation-301,An `Munchable` can be targeted from staking by front-running,validation-225,"griefing attack, QA at most, Mark Satisfactory per c4 validation rule",Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L138-L139,37
validation-66,Insufficient Stake Cap Enforcement in `stakeMunchable()` Function,validation-100,Off-by-one error,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L140-L141,37
findings-62,Incorrect comparison operator in _farmPlots,validation-131,see validation-268,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L258,37
validation-322,transferToUnoccupiedPlot() function can be exploited to front-run and DOS another user from staking.,validation-225,see validation-301,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L138-L139,38
validation-330,A timestamp earlier than `lastToilDate` will cause the entire `_farmPlots` function to revert.,validation-358,Looks like the situation can be triggered,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L281,39
validation-144,The validation on the number of staked Munchables against the intended maximum limit is implemented in a wrong way,validation-100,see validation-66,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L140-L141,39
validation-239,Farming plots prevents the landlord from petting munchables,findings-33,see findings-66,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L299-L300,40
validation-161,A landlord can't pet another munchable if his plot renter is too active,findings-33,see findings-66,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L299-L300,40
validation-114,Users can block landlord pet,findings-33,see findings-66,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L299-L300,40
validation-88,"Even if the user withdraws the staked funds, he will still get the same Schnibbles",validation-88,see validation-86,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L258-L261,40
validation-225,Malicious user/users may frontrun new staker with transferToUnoccupiedPlot() in order to DOS the stakeMunchables() function,validation-225,see validation-301,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L138-L139,41
validation-100,Off by one error when cheking munchablesStaked.legnth,validation-100,see validation-66,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L140-L141,41
validation-237,Staking to plotId zero confers advantages to the staker,validation-131,see validation-268,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L258,42
validation-220,UpdateTaxRate()'s new taxRate could be neglected from stakers that do not take any action deeming the newTaxRate insubstantial.,validation-244,UpdateTaxRate() not effective since the updating time point,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L91-L100,42
validation-142,Wrong comparison logic in comparing `_getNumPlots(landlord)` with `_toiler.plotId`,validation-131,see validation-268,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L258,42
validation-40,`updateTaxRate` doesn't update time,validation-169,timestamp should be updated together,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L92,42
validation-39,`updateTaxRate` doesn't farm plots,validation-244,see validation-220,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L91-L100,42
validation-295,Failed to identify the NFT staked in a dirty Plot due to missing equal check resulting in acquiring more schnibbles,validation-131,see validation-268,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L258,43
validation-233,"Impossible for the landlord to receive their rewards if the `tokenId` staked in their plot becomes inactive. Landlord also cannot remove the inactive user, effectively DoSing a particular plot",validation-233,see validation-162,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L40,43
validation-60,wrong calculation of schnibblesTotal ,validation-240,The divisor 100 should only be applied to bonus part,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L283-L286,43
validation-27,Incorrect check to verify if plotId exceeds available plots in `_farmPlots`,validation-131,see validation-268,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L258,43
validation-9,unfedSchnibbles are not being accounted for staked token with toiler state marked dirty ,findings-12,see validation-188,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L251,43
validation-201,Landlords can deliberately cheat in the game to earn yield via tax without effectively keeping their fund locked in the game,validation-88,see validation-86,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L258-L261,44
validation-159,Users staked at plot id zero of a lender can always farmPlots even when the lender have no plots,validation-131,see validation-268,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L258,44
validation-297,Incorrect calculation logic leads to inflated farmed schnibbles ,validation-131,see validation-268,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L258,45
validation-293,DOS and incorrect rewards are calculated while transferring the dirty NFT to the unoccupied plot,validation-108,see validation-238,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L213,45
validation-58,Users won't be able to stake/unstake their tokens if they have dirty toiler younger than plotMetadata last update for landlord,validation-358,see validation-330,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L281,45
findings-61,Users can stake one more than the expected maximum number of munchable stakes allowed. ,validation-100,see validation-66,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L140-L141,45
validation-287,Incorrect percentage calculation in `_farmPlots` leads to significant reduction in `unfedSchnibbles`,validation-240,see validation-60,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L283-L286,46
validation-286,Incorrect `PlotId` Check in `_farmPlots`,validation-131,see validation-268,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L258,46
validation-284,Incorrect calculation of user's earned schnibbles in farmPlots,validation-240,see validation-60,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L283-L286,46
findings-58,Attacker can fron-run `stakeMunchable()` to DoS normal users,validation-225,see validation-301,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L138-L139,46
findings-13,The first Munchables NFT staker of each landlord will never be marked as dirty and can always receive staking rewards,validation-131,see validation-268,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L258,46
validation-386,Protocol usage can be bricked for users Munchable if his plot becomes invalid due to a USD price drop in landlords collateral,findings-37,change of collateral USD value might affect available plots,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L345,47
validation-79,`renterMetadata.lastPetMunchable` is not updated,findings-33,see findings-66,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L299-L300,47
validation-52,Wrong input validation while tracking a dirty bool in _farmPlots(),validation-131,see validation-268,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L258,48
validation-377,User earns lesser schnibbles on their staked munchable if the landlord's plotId becomes unexistent,validation-88,see validation-86,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L258-L261,49
validation-296,Incorrect `timestamp` calculation for lastPetMunchable of the landlord,findings-33,see findings-66,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L258-L261,49
validation-261,"Permanent Loss of Rewards for ""Dirty"" Plots in _farmPlots()",findings-12,see validation-188,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L251,49
validation-38,`schnibblesTotal` uses wrong calculation to calculate the total,validation-240,see validation-60,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L283-L286,49
validation-15,A toiler and its landlord can keep earning unintended Schnibbles from at most one dirty plot.,validation-131,see validation-268,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L258,49
validation-375,LandLords may have outdated `MAX_TAX_RATE` or `MIN_TAX_RATE` when after `configUpdated` gets called,validation-99,see validation-99,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L270,50
validation-382,"Underflow in _farmPlots() prevents staker from farming plots, staking, unstaking and transferring munchables",validation-358,see validation-330,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L281,51
validation-371,Wrong Calculation In Edge Case,validation-131,see validation-268,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L258,51
validation-85,transferToUnoccupiedPlot did not update toileterState.plotId,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,51
validation-82,munchNFT can get stuck after staking.,validation-358,see validation-330,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L281,51
validation-360,Function transferToUnoccupiedPlot is allowing Multiple Plot Occupancy,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,52
validation-294,PlotId is not updated wven though the Plot of the NFT is changed,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,52
validation-173,Users will pay taxes to users that are not landlords anymore,validation-88,see validation-86,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L258-L261,52
validation-271,plotId is not updated while transferring to unoccupied plot,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,53
validation-258, Incorrect Timestamp Update for Dirty Plots,validation-88,see validation-86,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L258-L261,53
validation-234,Updating a land's tax rate does not enforce users to pay for it ,validation-244,see validation-220,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L91-L100,53
findings-49,lastPetMunchable incorrectly called in _farmPlots function,findings-33,see findings-66,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L299-L300,53
validation-366,DOS attacks due to no timeLock on `transferToUnoccupiedPlot`,validation-225,see validation-301,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L138-L139,54
validation-275,`lastUpdated` is not updated in `updateTaxRate`,validation-169,see validation-40,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L92,54
validation-313,_farmPlots() does not consider case when _getNumPlots(landlord) == _toiler.plotId for plot dirty check,validation-131,see validation-268,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L258,55
validation-129,Setting negative REALM_BONUSES results in inaccurate math,findings-2,"not sure if REALM_BONUSES would be a negative value in real case, mark Satisfactory for visibility for sponsor",Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L271,55
validation-103,Incorrect Schnibble calculation in `_farmPlots` reduces total rewards instead of applying bonus,validation-240,see validation-60,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L283-L286,55
validation-305,"Users may avoid farming to accumulate rewards with the previous, lower tax rate, adding up to the possibility of edge cases",validation-244,see validation-220,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L91-L100,56
findings-71,Users lose out on subsequent rewards when the plotId  of their staked munchable becomes invalid,validation-108,see validation-238,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L213,56
findings-50,landlord can frontrun a stake to increase their tax rate,validation-216,see validation-388 ,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L166,56
validation-171,transferToUnoccupiedPlot Function is allowing Multiple Plot Occupancy,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,57
validation-143,`toilerState[tokenId].plotId` is not updated after a `tokenId` moves from an old plot to a new plot,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,57
validation-141, Incorrect Application of Bonus in Schnibble Calculation,validation-240,see validation-60,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L283-L286,57
validation-96,`landlord` cannot earn rewards on plots marked as dirty after unstaking and restaking tokens in `lockManager` ,validation-88,see validation-86,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L258-L261,57
validation-69,Users can avoid the `dirty` penalty ,validation-47,dirty not set in time,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L260,57
validation-364,Function transferToUnoccupiedPlot Fails to Update toilerState[tokenId].dirty,validation-108,see validation-238,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L213,58
validation-235,Only users who call the LandManager contract may get their toiler states dirty,validation-47,see validation-69,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L260,58
validation-166, Incorrect update of lastPetMunchable state,findings-33,see findings-66,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L299-L300,58
validation-128,LastUpdated not updated in updateTaxRate causing data inaccuracy,validation-169,see validation-40,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L92,58
validation-77,Landlord can pet multiple times in a row,findings-33,see findings-66,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L299-L300,58
findings-53,Inability to Enforce Updated Tax Rate on Staked Users,validation-244,see validation-220,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L91-L100,58
validation-374,Whenever a `_reconfigure` happens to `BASE_SCHNIBBLE_RATE` some users will take advantages of it,validation-99,see validation-99,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L270,59
validation-363,DOS attacks due to no timeLock between `stakeMunchable` and `unstakeMunchable`,validation-225,see validation-301,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L138-L139,59
validation-350,Not updating plotId after transferring to a new unoccupied plot.,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,59
validation-325,Off-by-one error in _farmPlots() allows out of range plotId to continue earning schnibbles,validation-131,see validation-268,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L258,59
validation-324,Transaction ordering can result in user staking a munchible to higher tax rate than expected,validation-216,see validation-388,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L166,59
validation-121,Transfering tokens to unoccupied plot won't update toiler state properly,validation-108,see validation-238,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L213,59
validation-55,`LandManager::farmPlots` can allow landlords to have their munchables petted before the `pet` time limit has expired,findings-33,see findings-66,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L299-L300,59
findings-65,Munchables can be deadlocked due to underflow in certain conditions,validation-358,see validation-330,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L281,59
validation-323,Landlords may lose tax due to stakers's lack of required actions,validation-233,see validation-162,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L40,60
validation-146,Type casting in _farmPlots can go to max value of uint256,validation-240,see validation-60,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L271,60
validation-104,Incorrect update of `lastPetMunchable` in `LandManager` messes with landlord's petting cooldown for the farming Munchable,findings-33,see findings-66,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L299-L300,60
validation-91,Landlord can loose on potential profits.,validation-244,see validation-220,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L91-L100,60
validation-73,Users can get their NFTs completely DOSed,validation-358,see validation-330,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L281,60
validation-45,`proposeUSDPrice` can be manipulated into changing the price for different contracts,findings-37,see validation-386,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L345,60
validation-7,`LandManager::transferToUnoccupiedPlot` doesn't set `toilerState[tokenId].dirty` to false which leads to a user being unable to receive rewards,validation-108,see validation-238,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L213,60
validation-316,Missing toilerState[tokenId].plotId update in function transferToUnoccupiedPlot() ,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,61
validation-302,Approval Of A New USD Price Can Make Existing Plot ID's Dirty ,findings-37,see validation-386,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L345,61
validation-101,"Munchables remain unproductive after `transferToUnoccupiedPlot` due to an uncleared 'dirty' flag, leading to loss of Schnibble generation",validation-108,see validation-238,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L213,61
validation-92,Utilizing outdated `latestTaxRate` to calculate the `schnibblesLandlord`,validation-244,see validation-220,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L91-L100,61
validation-49,"`transferToUnoccupiedPlot` can be used to ""clone"" and occupy plots",findings-33,see findings-66,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L299-L300,61
validation-318,"If value of `lockedTokens[_player][configuredTokenContracts[i]].quantity *configuredTokens[configuredTokenContracts[i]].usdPrice` is less than or equal to `1e10` , `_getNumPlots will return wrong value",findings-37,see validation-386,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L345,62
validation-231,Invalid Stake Limits for Munchables in the LandManager Contract,validation-231,see validation-165,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L140,62
validation-215,"transferToUnoccupiedPlot Function Fails to Update toilerState[tokenId].dirty, Preventing Schnibble Collection",validation-108,see validation-238,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L213,62
validation-81,Reversion in `_farmPlots()` Function Due to Incorrect `timestamp` Usage,validation-358,see validation-330,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L281,62
validation-42,Front-running TransferToUnoccupiedPlot Causing Griefing,validation-225,see validation-301,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L138-L139,62
validation-200,Wrong amount of staked munchables are allowed.,validation-131,see validation-268,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L258,63
validation-321,"Inconsistent valid plotId checks, results in one free plot for landlords",validation-131,see validation-268,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L258,64
validation-223,Points farming will still be on the `oldPlotId` after `transferToUnoccupiedPlot`.,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,64
validation-44,`plotId` of toilerState is not updated in transferToUnoccupiedPlot(),validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,64
validation-243,Front-Running Vulnerability in Tax Rate Manipulation  ,validation-216,see validation-388 ,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L166,65
findings-26,The `dirty` flag isn't updated when an NFT is transfered to an unocuppied plot,validation-108,see validation-238,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L213,65
validation-157,User can occupy all unoccupied lender's plots by only staking one NFT,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,66
validation-47,Users can avoid their plots getting `dirty` when the price of assets changes,validation-47,see validation-69,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L260,66
findings-17,"In some cases, the staker can choose to Dos a plot of land landlord so that it cannot generate any revenue",validation-108,see validation-238,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L213,66
validation-359,in `updateTaxRate()` no time lock allows The LandLord to have `MAX_TAX_RATE` in sneaky way,validation-216,see validation-388 ,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L166,67
validation-136,Unnecessary update in landlord's `lastPetMunchable` variable may discourage them from locking high amounts of tokens,findings-33,see findings-66,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L299-L300,67
validation-89,The transferToUnoccupiedPlot function does not consider dirty NFTs,validation-108,see validation-238,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L213,67
validation-221,User can stake to plotId = 0 when calling stakeMunchables() skipping core game logic,validation-131,see validation-268,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L258,68
validation-172,Users can still update tax rates even if they are not landlords anymore,validation-172,"mismatch of doc and implementation, QA likely",Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L104,68
validation-37,plotId in ToilerState is not being updated on transfer to Unoccupied plot,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,68
validation-274,Landlords Can Manipulate Tax Rates Without User Consent,validation-216,see validation-388 ,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L166,69
validation-369,in `farmPlots()` wrong logical opeartor will make `plotId` to have full rewards,validation-131,see validation-268,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L258,70
validation-260,`toilerState[tokenId].poolId` is not changed when `transferToUnoccupiedPlot` is called,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,70
findings-44,Potential Underflow in _farmPlots,validation-358,see validation-330,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L281,70
validation-282,Specific Landlord & Token ID Attributes Can Cause Users NFT To Be Stuck,validation-240,see validation-60,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L283-L286,71
validation-219,User can stake multiple munchables on a single plot,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,71
validation-138,Incorrect Percentage Calculation in `schnibblesTotal` Formula,validation-240,see validation-60,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L283-L286,71
validation-110,"If _farmPlots is executed when _getNumPlots(landlord) < _toiler.plotId is true for a staked munchable, the schnibblesTotal produced then after  will not be accounted for until the munchable is unstaked and staked again.",validation-108,see validation-238,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L213,71
validation-10,Users can own one plot for free because of improper check in `LandManager::_farmPlots`,validation-131,see validation-268,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L258,71
validation-292,Transferring To & Unstaking From A Plot Id Can Render The Plot Useless,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,72
findings-4,The `transferToUnoccupiedPlot` function does not update the plotId in `ToilerState`,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,72
validation-236,Users who know their toiler state will become dirty can trigger an update to the current timestamp to earn more,validation-88,see validation-86,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L258-L261,75
findings-48,Forced Default Tax Rate on Initial Plot Metadata ,findings-48,see validation-177,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L104-L114,75
validation-380,toilerState plotId is not updated when using `transferToUnoccupiedPlot` so transferring tokens to a different plot will not prevent them being marked as dirty and excluded from bonus calculations,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,76
validation-22,`transferToUnoccupiedPlot` is lacking updating `dirty field` which prevent player from earning when farming,validation-108,see validation-238,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L213,76
findings-57,Function `transferToUnoccupiedPlot()` did not set new `toilerState.plotId`,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,76
validation-83,Malicious actor can take advantage of `transferToUnoccupiedPlot` to occupy plot with almost no costs.,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,77
findings-41,Lack of Validity Check for Plots in _farmPlots Function Prevents Reward Distribution,validation-88,see validation-86,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L258-L261,77
validation-232,Key state changes not made to `toilerState` mapping during `transferToUnoccupiedPlot` preventing correct issuance of rewards,validation-108,see validation-238,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L213,78
validation-224,"transferToUnoccupiedPlot() does not reset the toiler.dirty flag whenever we occupy a new ""clean"" slot",validation-108,see validation-238,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L213,79
validation-188,Denial of service due to lack of a proper opt-out mechanism can result in a user's rights being violated,findings-12,dirty flag can't be automatically recovered,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L251,79
validation-147,plotId is not updated when transferring to an unoccupied plot,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,79
validation-102,Munchable's `plotId` not updated during `transferToUnoccupiedPlot`,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,79
findings-46,Transferring a `munchNFT` from an unavailable plot to an available one doesn't allow the renter to earn schnibbles once the dirty state of the toilerState is set to true,validation-108,see validation-238,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L213,79
validation-13,Incorrect calculation of total Schnibbles in farming plots,validation-240,see validation-60,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L283-L286,80
validation-53,Malicious users can prevent other users from having their munchables petted,findings-33,see findings-66,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L299-L300,81
findings-59,The landlord and staker can collide to farm schnibbles without locking the required tokens,validation-88,see validation-86,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L258-L261,81
findings-43,Incorrect Plot Validation in _farmPlots Function,validation-131,see validation-268,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L258,81
findings-14,"When the pledger located on a dirty plot transfers to an unoccupie non dirty plot, _toiler will be marked as dirty and will never receive any profit",validation-108,see validation-238,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L213,82
validation-391,User can stake on occupied plot and transfer munchable to occupied plot overwriting the munchable currently on the plot,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,83
validation-368,`plotId` not updated in `LandManager.sol#transferToUnoccupiedPlot()` function,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,83
validation-337,Incorrect schnibble calculations in _farmPlots() leads to extremely high schnibble rewards,validation-240,see validation-60,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L283-L286,84
validation-310, `plotID ` of `toilerState` mapping not updated in the `transferToUnoccupiedPlot` function. ,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,84
validation-6,`LandManager::transferToUnoccupiedPlot` doesn't update the `toilerState[tokenId].plotId` variable,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,84
validation-381,"LandManager.sol :: transferToUnoccupiedPlot() does not update the plotId in the ToilerState struct, which can result in different NFTs having the same plotId.",validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,85
validation-372,Casting Underflow in `farmplots()`  making user able to get huge number of schnibbles ,validation-240,see validation-60,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L283-L286,85
validation-264,User can stake 11 munchables for one Land. (Confirmed by sponsor),validation-100,see validation-66,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L140-L141,85
validation-24,`_farmPlots` is not detecting properly the `plot's dirtiness` which might allow player to earn even on an invalid plot,validation-131,see validation-268,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L258,85
validation-23,`transferToUnoccupiedPlot` is lacking updating `plotId field` which break farming accounting and might prevent player from earning when farming,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,87
findings-52,Inaccurate lastPetMunchable Updates Leading to Exploitation,findings-33,see findings-66,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L299-L300,87
findings-25,Missing `plotId` update when NFT is transfered to an unocuppied plot,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,87
validation-358,in `farmPlots()` an underflow in edge case leading to freeze of funds (NFT),validation-358,see validation-330,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L281,88
validation-246,``stakeMunchable()`` allows staking of 11 munchables due to ``>`` being used instead of ``>=``.,validation-100,see validation-66,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L140-L141,88
validation-76,Landlord can lock their assets only for the time when harvesting,validation-88,see validation-86,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L258-L261,88
validation-12,A Malicious Staker Can Occupy His Landlord's All Plots With Only One Munchable,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,89
validation-320,Attacker can occupy almost all plots of each landlord ,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,91
findings-60,Stakers are DOSsed from farming plots and unstaking if the landlord's locked value decreases,validation-358,see validation-330,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L281,91
findings-56,Malicious staker can prevent a landlord from gaining rewards from petting other munchables by spamming farmPlots,findings-33,see findings-66,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L299-L300,92
validation-376,Wrong calculation in ```_farmPlots(address _sender)``` function,validation-240,see validation-60,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L283-L286,93
findings-73,Users who transfers from dirty plots are unable to accrue rewards due to persistent dirty flag,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,93
findings-67,`updateTaxRate` function does not update `lastUpdated` to current timestamp,validation-169,see validation-40,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L92,94
validation-327,Error on `schnibblesTotal` calculation : Incorrect Percentage Calculation & Overflow ,validation-240,see validation-60,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L283-L286,95
validation-227,`_farmPlots()` will get DoSed because of an overflow when calculating `schnibblesTotal`,validation-358,see validation-330,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L281,96
findings-28,Incorrect formula for calculating the total schnibbles accrued,validation-240,see validation-60,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L283-L286,96
validation-34,Solution to edge case by farming plots on calling `LockManager::unlock`,validation-34,"per the readme's special rule of this contest, reports focusing on the listed known issues are accepted",Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L251,98
findings-11,"When the collateral price of Landlord drops, causing _getNumPlotsdrop ，if Landlord does not make any updates, the staker's NFT may get stuck",validation-358,see validation-330,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L281,99
validation-120,The Plot is not marked dirty in _farmPlots() when PlotId == No of Plots,validation-131,see validation-268,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L258,100
findings-33,Landlord's lastPetMunchable Metadata Updated Incorrectly on Renter Farming,findings-33,see findings-66,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L299-L300,100
validation-249,``transferToUnoccupiedPlot()`` doesn't update ``toilerState`` with the new plot id.,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,101
validation-93,`landlord` can receive rewards without staked tokens in `lockManager`,validation-131,see validation-268,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L258,101
findings-35,Blacklisting tokens during stake prevents unstaking and occupies landlord plots,findings-35,see validation-389,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L11,102
validation-341,A malicious user can receive schnibbles rewards without having a locked amount throughout the full period,validation-88,see validation-86,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L258-L261,105
validation-111,Schnibbles Can Be Farmed for Tokens in Invalid Plots,validation-88,see validation-86,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L258-L261,106
findings-45,toilerState[tokenId].plotId not updated in transferToUnoccupiedPlot function,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,106
findings-42,Failure to Update Dirty Flag in transferToUnoccupiedPlot Prevents Reward Accumulation On Valid Plot,validation-108,see validation-238,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L213,107
validation-351,All user`s staked munchables will be temporary stuck if they have staked munchable after the last tax rate update,validation-88,see validation-86,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L258-L261,109
validation-211,The `transferToUnoccupiedPlot()` function doesn't update the `toilerState[tokenid].plotId` to the new `plotId` allowing attackers to make all plots owned by a landlord unusable,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,109
validation-25,Critical states are not updated when transferrnig tokens to new plot,validation-108,see validation-238,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L213,110
validation-108,Transfering the tokenId from invalid to valid plot doesn’t change the dirty status and hence staker continue to earn 0 rewards,validation-108,see validation-238,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L213,111
validation-393,Users can avoid paying new tax by delaying their call to the `farmPlots` function after the landlord increased tax rate,validation-244,see validation-220,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L91-L100,113
findings-40,Renters staked NFT `toilerState.dirty` will be incorrectly set as true in an edge case whereby the renter transfers their NFT to another plot,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,114
findings-22,"Due to unsafe type conversion, there may be anomalies in the calculation of staking rewards,causing Staker's NFT to be permanently stuck",validation-240,see validation-60,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L283-L286,115
validation-139,"The `transferToUnoccupiedPlot` function doesn't update `toilerState[tokenId].plotId` to the new plotID, a malicious user can DOS a landlord by occupying all their plots with one token. ",validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,117
validation-367,Stepwise Jump Attack in `LandManager.sol`,validation-99,see validation-99,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L270,119
findings-38,Incorrect timestamp updating for invalid plots due to configured token becoming inactive,validation-88,see validation-86,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L258-L261,119
validation-217,Landlord's plot stays occupied even when the user has unstaked his munchable. DoS for other users.,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,120
findings-69,Only 1% of the `schnibblesTotal` earned is distributed to landlord and renter,validation-240,see validation-60,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L283-L286,121
findings-2,If finalBonus is negative LandManager::_farmPlots() will revert due to multiplication which results in a number greater than type(uint256).max,findings-2,see validation-129,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L271,121
validation-212,"Attackers can farm plots every 10 minutes or less, making `SnuggeryManager.pet()` function no longer work for the attacked landlord",findings-33,see findings-66,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L299-L300,125
findings-34,Incomplete Update of `ToilerState` in `LandManager::transferToUnoccupiedPlot()`,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,125
validation-276,One more plot can be harvested than _getNumPlots.,validation-131,see validation-268,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L258,126
validation-303,"Inconsistent state of toiler's plotId, can lead to undeserved rewards for users and landlords",validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,127
validation-197,Incorrect total schnibbles calculation in `LandManager::_farmPlots` results in loss of users schnibbles,validation-240,see validation-60,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L283-L286,127
validation-187,No farming points counted,findings-12,see validation-188,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L251,127
validation-169,Failure to Update `lastUpdated` in `updateTaxRate` Function Causes Inaccurate Calculations in `_farmPlots` Function,validation-169,see validation-40,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L92,127
findings-31,Discrepancy in plot ID validation allows invalid plots to farm schnibbles,validation-131,see validation-268,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L258,127
validation-332,Wrong calculation of schnibblesTotal due to improper percentage division,validation-240,see validation-60,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L283-L286,129
validation-196,Negative rewards farming cannot be possible since the `schnibblesTotal` and `schnibblesLandlord` assigned as `uint256` instead of `int256`,findings-2,see validation-129,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L271,129
validation-257,User can go unscathed and farm all points as if his plot was valid all the time - while the plot was invalid due to unlocking by landlord,validation-88,see validation-86,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L258-L261,130
findings-68,"In an edge case where the `finalBonus` returns 0, the landlords and renters forfeit any schnibbles for the duration locked",validation-240,see validation-60,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L283-L286,131
findings-24,The _farmPlots function fails to correctly handle the tolier.plotId == _getNumPlots(landlord) edge case,validation-131,see validation-268,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L258,131
findings-18,The staker can ignore the landlord  increase the TaxRate until they receive a satisfactory reward and collect it all at once,validation-244,see validation-220,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L91-L100,133
validation-240,[H-01] Miscalculation in `_farmPlots` function could lead to a user unable to unstake all NFTs,validation-240,see validation-60,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L283-L286,134
findings-29,"Blacklisted account can become landlord, gaining the schnibbles tax from renter farming",findings-29,The situation of blacklisted account is not processed in LandManager,Satisfactory,"https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L11,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/tokens/MunchNFT.sol#L111",134
findings-36,Griefing by occupying dirty plots,validation-233,see validation-162,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L251,138
validation-202,Single plot can be occupied by multiple renters,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,139
validation-21, A staker can still stake more than the accepted max,validation-100,see validation-66,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L140-L141,141
findings-12,Protocol's handled edge case introduces another issue of not updating `toiler.dirty` states in a new edge case,findings-12,see validation-188,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L251,141
validation-74,Any munchNFT owner can DoS all landlord because of a missing toilerState update in transferToUnoccupiedPlot,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,142
validation-164,Incorrect PlotId Update in `transferToUnoccupiedPlot` Function Leads to Errors in `_farmPlots` Function,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,145
validation-124,Critical Front-Running Exploit: How Malicious Landlords Can Deceive Renters and Compromise the Integrity of the Munchables NFT Platform,validation-216,see validation-388 ,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L166,146
validation-204,Landlords will continue to earn schnibbles even without active plots,validation-131,see validation-268,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L258,148
validation-338,Improper check in ```_farmPlots(address _sender)``` function,validation-131,see validation-268,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L258,150
findings-37,Incorrect timestamp updating for invalid plots due to USD price fluctuation,findings-37,see validation-386,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L345,151
validation-155,Unsafe cast from int256 to uint256 in `LandManager._farmPlots(...)` will overflow,findings-2,see validation-129,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L271,152
findings-32,`schnibblesTotal` calculation with the `finalBonus` can result in underflow and incorrect value,findings-2,see validation-129,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L271,154
validation-43,Stale Data After TransferToUnoccupiedPlot Call,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,155
validation-205,Malicious renter can occupy all of landlord’s plots,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,158
validation-253,Using `LandManager::farmPlots(...)` blocks landlords from petting other munchables,findings-33,see findings-66,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L299-L300,163
validation-216,`function::updateTaxRate` allows for Oscillating Tax Rate Trap allowing malicious landlords to manipulate the tax rate system to their advantage.,validation-216,see validation-388 ,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L166,164
findings-20,"When a landlord number of plots decrease, some stakers that shouldn't receive rewards anymore will continue to do",validation-131,see validation-268,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L258,165
findings-5,Attacker can occupy all landlord's plots with one NFT,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,172
validation-365,Inconsistent Staking Rewards Due to Dirty Flag Mismanagement,findings-12,see validation-188,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L251,181
validation-63,Overflow in _farmPlots leads to player not able to stake / unstake / transfer to plot any munchable,validation-240,see validation-60,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L283-L286,191
validation-36,Integer overflow in Schnibbles Calculation Leading to Excessive Rewards,findings-2,see validation-129,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L271,194
findings-8,User can prevent his `ToilerState` from being marked as dirty and still occupy unavailable plot,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,195
validation-248,Landlord would lose tax upon tax increment,validation-244,see validation-220,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L91-L100,196
validation-329,No set of ```toilerState.plotId``` in ```transferToUnoccupiedPlot()``` function could lead to DoS,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,200
validation-336,Invalid plots should not receive any rewards,validation-88,see validation-86,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L258-L261,204
validation-106,plotId not updated after transfer toUnoccupied plot,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,207
findings-54,Known edge case issue solution,findings-54,"per the readme's special rule of this contest, reports focusing on the listed known issues are accepted",Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L232-L310,207
validation-370,State Variable Update and Reconfiguration Issues in `LandManager.sol`,validation-244,see validation-220,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L91-L100,213
validation-107,Underflow in _farmPlots leads to stuck munchables,findings-37,see validation-386,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L345,214
validation-334,Inactive players will get rewarded more schnibbles than active ones ,validation-334,"not sure if it's valid, mark Satisfactory for visibility",Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L232-L310,215
validation-285,Stakers could harvest schnibbles based on wrong BASE_SCHNIBBLE_RATE,validation-99,see validation-99,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L270,222
findings-7,`dirty` flag is not updated in `transferToUnoccupiedPlot`,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,227
findings-19,LandManager::transferToUnoccupiedPlot() doesn't update the plotId in the ToilerState struct,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,238
validation-203,DOS on LandManager when `getLockedWeightedValue` suddenly changes,validation-88,see validation-86,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L258-L261,240
validation-51,UINT256 underflow allows to farm a large amount of Schnibbles,validation-240,see validation-60,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L283-L286,242
validation-206,Malicious renter can grief landlords to receive fewer schnibbles,validation-233,see validation-162,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L251,251
validation-344,A staker has no incentive to actively farm if a landlord increases tax rate,validation-244,see validation-220,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L91-L100,259
validation-244,User’s schnibbles rewards in `LandManager::_farmPlots(...)` are not properly calculated when the landlord's tax rate changes,validation-244,see validation-220,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L91-L100,264
findings-9,User can prevent landlord from petting other munchables,findings-33,see findings-66,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L299-L300,281
validation-163,Incorrect toilet state updates caused users to be unable to correctly transfer to unoccupied plots to obtain farm rewards,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,287
validation-117,Transfering tokenId to unoccupied plot will lead to new plot id getting blocked forever as transferToUnoccupiedPlot() doesn't update the plotId in toilerState,validation-117,see validation-280,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L213,291
validation-131,Invalid validation in _farmPlots function allowing a malicious user repeated farming without locked funds,validation-131,see validation-268,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L258,319
validation-148,Incorrect calculation of rewards in the _farmPlots function results in users getting wrong/huge rewards or causing munchables to always get stuck with overflow errors ,validation-240,see validation-60,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L283-L286,360
validation-158,The more critical attack vector triggered by the `setLockDuration` function for excess farming rewards due to the incorrect tracking of actual farming time,validation-88,see validation-86,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L258-L261,460
validation-245,Dirty toilers continue to harvest schnibbles and vice-versa,findings-12,see validation-188,Satisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L299-L300,603
validation-283,Use `safeTransferFrom` instead of `transferFrom` for ERC721 transfers,,"1. munchNFT is received from mainAccount and then sent back to it, therefore we can make sure the mainAccount can receive munchNFT;
2. This design choice also helps to mitigrate potential reentrancy attack of safeTransferFrom()",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L152,21
validation-61,NFTOverlord.sol startReveal() not use nonReentrant modifier that prevents a function from being re-entered,,out of scope,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/overlords/NFTOverlord.sol#L74,22
validation-149,ERC721 should use safeTransferFrom,,"1. munchNFT is received from mainAccount and then sent back to it, therefore we can make sure the mainAccount can receive munchNFT;
2. This design choice also helps to mitigrate potential reentrancy attack of safeTransferFrom()",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L152,24
validation-31,getSmallIntArray in ConfigStorage.sol length mismatch between smallIntArrayStorageLength[_key] and smallIntArrayStorage,,out of scope,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/config/ConfigStorage.sol#L199,24
validation-265,Not checking return value in ERC721 transferFrom ,,"1. munchNFT would revert on transfer failure;
2. transferFrom() has no return value;",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L152,25
validation-218,`unstakeMunchable()` should not have notPaused modifier,,No sufficient proof that this is an issue rather than a design choice,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L175,25
validation-194,Ignored Return Values in LandManager.sol,,not a external call,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L113,25
validation-29,setAddresses in ConfigStorage.sol mismatch between the lengs of _keys and values.,,out of scope,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/config/ConfigStorage.sol#L238,25
validation-2,Users can stake munchables on plots that do not have `currentTaxRate` set,,"While Landlords' first locking of funds, updatePlotMetadata() will be called to init tax rate, please refer:
https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/AccountManager.sol#L154 and 
https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LockManager.sol#L341",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L131-L171,25
validation-241,Unchecked External Callbacks,,"1. munchNFT would revert on transfer failure;
2. transferFrom() has no return value;",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L152,26
validation-133,Missing access control in initialize(address),,initialize can be called only once during deployment,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L45,26
validation-270,Use safeTransferFrom when transferring munchNFTs,,"1. munchNFT is received from mainAccount and then sent back to it, therefore we can make sure the mainAccount can receive munchNFT;
2. This design choice also helps to mitigrate potential reentrancy attack of safeTransferFrom()",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L152,27
validation-331,Rounding in `_getNumPlots` disfavors landlords and disincentivizes land ownership (locking tokens),,"The rounding here should not favor landlord, otherwise users can lock only 1 wei to create 1 plot",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L345,28
validation-137,Using transferFrom on ERC721 tokens transfer ,,"1. munchNFT is received from mainAccount and then sent back to it, therefore we can make sure the mainAccount can receive munchNFT;
2. This design choice also helps to mitigrate potential reentrancy attack of safeTransferFrom()",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L152,28
validation-193,Reentrancy Vulnerability in LandManager.sol,,incorrect Slither report,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L300,29
validation-349,Non-fixed tax rate allows landlord to increase tax once stakers are realized,,No sufficient proof that this is an issue rather than a design choice,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L292,30
validation-290,An attacker can prevent a victim from staking their MunchNFT,,A registered account can not be added as subaccount,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L142,31
validation-186,Wrong calculation of Landlord's cut,,1e18 is 100% here,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L287,31
validation-4,Using ERC721.transferFrom() instead of safeTransferFrom() may cause the user's NFT to be frozen in a contract that does not support ERC721,,"1. munchNFT is received from mainAccount and then sent back to it, therefore we can make sure the mainAccount can receive munchNFT;
2. This design choice also helps to mitigrate potential reentrancy attack of safeTransferFrom()",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L152,31
validation-140,Owners of MUNCH tokens may never be able to unstake if the contract gets permanently paused,,No sufficient proof that this is an issue rather than a design choice,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L175,32
validation-291,Users can start staking their munchables even though the landlord has not specified the taxrates,,see validation-2,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L131-L171,34
validation-152,Potential Reentrancy Issues,,transferFrom() has no Reentrancy risk,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L152,34
validation-300,An attacker can prevent a landlord from updating its tax rate,,registered account can not be added as subaccount,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L93,35
validation-273,Precision loss in _farmPlots(),,negligible rounding error,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L287,35
findings-74,LandManager.sol should implement IERC721Receiver,,the only use of transferFrom() don't need to implement  IERC721Receiver,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L11,35
validation-184,Relatively small tax rate leads to 0 schnibble rewards,,negligible rounding error,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L280-L289,36
validation-41,`unstakeMunchable` is pauable,,No sufficient proof that this is an issue rather than a design choice,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L175,36
validation-299,A plot is wrongly assumed to be `dirty` even when the landlord's plots are not fully occupied,,"In this case, users should call transferToUnoccupiedPlot() to occupy low plots",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L258-L261,38
validation-288,An attacker can prevent a victim from unstaking their staked MunchNFT,,registered account can not be added as subaccount,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L173-L179,38
validation-109,Unfair Tax Rate Adjustment for Staked NFTs,,landlord's currentTaxRate is indeed recorded in toilerState[tokenId].latestTaxRate ,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L92,38
validation-46,The unbounded Loop in `_farmPlots` Function may lead to the block gas limit being exceeded,,staked length is limited to 10,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L232-L310,38
validation-317,Fluctuating Token Values Can Prevent Legitimate Stakers from Farming Due to Decreased numOfPlots,,Not an issue,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol?plain=1#L344-L345,39
validation-3,Using `ERC721.transferFrom()` may cause the user's NFT to be frozen in a contract that does not support ERC721,,"1. munchNFT is received from mainAccount and then sent back to it, therefore we can make sure the mainAccount can receive munchNFT;
2. This design choice also helps to mitigrate potential reentrancy attack of safeTransferFrom()",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L195,40
validation-272,Unsafe Cast From uint8 to int8,,insufficient proof,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L277-L279,41
validation-134, Missing onERC721Received in LandManager.sol,,the only use of transferFrom() don't need to implement  IERC721Receiver,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L11,41
validation-94,Admin Privileges Allow Potential Misuse in MunchNFT Contract,,out of scope,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/tokens/MunchNFT.sol#L74,41
validation-28,Potential Reentrancy Vulnerability in `updateTaxRate` Function,,no Reentrancy  risk here,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L92-L101,41
validation-308,It's still possible to create multiple accounts to bypass checks,,"checks based on address level is enough, as landlord's locking value is also based on address",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L140https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L137-L1388,42
validation-168,`triggerPlotMetadata` can be triggered by users who don't have locked funds,,duplicated submission with validation-172 from same warden,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L104,42
validation-98,Precision loss while calculating `schnibblesLandlord` in _farmPlots(),,negligible rounding error,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L287,42
validation-378,Same TokenId can be used to buy multiple plots,,a staked tokenId has already be held in LandManager contract,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L131-L171,43
validation-132,Larger amount of MunchablesStaked results in self DOS,,the length is limited to 10 while staking,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L318,43
validation-289,Attacker can stake and earn rewards tax free due to missing plot metadata initialization check,,"While Landlords' first locking of funds, updatePlotMetadata() will be called to init tax rate, please refer:
https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/AccountManager.sol#L154 and 
https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LockManager.sol#L341
otherwise, there will be no valid plots to stake due to zero value locked",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L131,44
validation-230,Unsafe use of transferFrom instead of _safeTransferFrom,,"1. munchNFT is received from mainAccount and then sent back to it, therefore we can make sure the mainAccount can receive munchNFT;
2. This design choice also helps to mitigrate potential reentrancy attack of safeTransferFrom()",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L195,44
validation-281,Lack of check index out of bounds when calculating final bonus,,revert would be auto triggered by solidity compiler while out of bound,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L270-L279,45
validation-210,Landlord's player data will be updated on different address,,LockManager has limited sub account can not be an landlord,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L300,46
findings-70,Validation for plotId is incorrect landlords will have one fewer available plot,,valid plotId is from 0,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L145-L146,47
validation-373,Allowing Unauthorized Metadata Updates,,onlyConfiguredContract(StorageKey.AccountManager),Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L116-L129,48
validation-347,Allowing Unauthorized Metadata Updates,,onlyConfiguredContract(StorageKey.AccountManager),Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L116-L129,48
validation-278,transferToUnoccupiedPlot doesn't check if it's the same landlord,,"landlord is from toiler, not from input: _getNumPlots(_toiler.landlord)",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L199-L226,48
validation-266,triggerPlotMetadata() can be frontrun to avoid taxRates,,"While Landlords' first locking of funds, updatePlotMetadata() will be called to init tax rate, please refer:
https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/AccountManager.sol#L154 and 
https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LockManager.sol#L341
otherwise, there will be no valid plots to stake due to zero value locked",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L104,49
validation-354,It is possible to stake munchables to the zero address but they can never be unstaked,,"for zero address, there will be no valid plots to stake due to zero value locked",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L131-L171,51
validation-174,Users can stake same munchable to multiple landlords,,a staked tokenId has already be held in LandManager contract,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L131,51
validation-135,Incorrect variable assignment and tokenId deletion,,incorrect understanding of the function,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L320,52
validation-183,Potential tax rate setting leads schnibblesLandlord to be 0,,negligible rounding error,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L280-L289,53
validation-175,Incorrect plot range validation,,plotId starts from 0,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L145-L146,54
validation-72,"`unstakeMunchable` function transfers after `mainAccount` and `tokenId` is deleted, will cause function to fail",,munchablesStaked mapping and tranfer of NFT are independent,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L193-L195,54
validation-385,`_removeTokenIdFromStakedList` does not check for duplicate tokenId in the `munchablesStaked[address]` mapping,,no duplicated tokenId is ensured while staking,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L312-L330,55
validation-279,"Return value of `transferFrom` is not checked in `stakeMunchable` function, in case of failure one can still successfully stake munchable. ",,"1. munchNFT would revert on transfer failure;
2. transferFrom() has no return value;",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L152,55
findings-21,Landlord weights get severely skewed down because the `PRICE_PER_PLOT` is scaled in 18 decimals whereas the weights are not,,usdPrice has 18 decimals,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L345,55
validation-130,Missing access control in _removeTokenIdFromStakedList,,internal  function,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L312,57
validation-65,Malicious user can take advantage of `unTriggeredPlotMetadata` to avoid taxRates,,"While Landlords' first locking of funds, updatePlotMetadata() will be called to init tax rate, please refer:
https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/AccountManager.sol#L154 and 
https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LockManager.sol#L341
otherwise, there will be no valid plots to stake due to zero value locked",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L166,59
validation-112,"Unstaking Munchables staked at plotId of zero, will still indicate that the plotId is still in use.",,plotOccupied[landlord][plotId].occupied is for the purpose,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L187,60
validation-54,Insufficient Bounds Check on REALM_BONUSES Array Leading to possible Out-of-Bounds Errors,,Insufficient proof,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol?plain=1#L272,60
validation-357,The portion of finalBonus corresponding to rarity can be negative if the RARITY_BONUSES value is sufficiently high,,insufficient proof in which realistic case the RARITY_BONUSES would exceed 128,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L277-L279,62
validation-209,Wrong account is passed as input in updatePlayer for landlord in _farmPlots(),,LockManager has limited sub account can not be an landlord,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L300,62
validation-167,Users can update plots even if they are not landlord's anymore,,duplicated submission with validation-172 from same warden,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L104,63
validation-125,NFT approve is not revoked after unstaking,,It's users' rights and responsibility to approve and disapprove,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L173-L197,63
findings-27,`forceFarmPlots` modifier is farming the NFTs of `msg.sender` instead of the main account,,mainAccount is retrieved in _farmPlots(),Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L135,64
validation-252,Unchecked Token Transfer Vulnerability,,"1. munchNFT would revert on transfer failure;
2. transferFrom() has no return value;",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L152,65
validation-228,Subaccounts Can Modify Landlord's Tax Rate Through `updateTaxRate` Function in `LandManager` Contract,,subAccount is trusted by mainAccount(landlord),Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L92-L101,70
validation-19,Wrong implementation of `BaseBlastManagerUpgradeable.sol` and `BaseConfigStorageUpgradeable`,,It's no problem as initilize() is intended to be called in construtor function of proxy contract,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/BaseBlastManagerUpgradeable.sol#L17-L21,72
validation-307,Missing index check in `LandManager::_farmPlots()` could lead to DoS due to out-of-bonds error,,"solidity compiler can protect out of bound with revert, and the issue can only be triggered by admin's wrong config, the chance is very low. Therefore, the suggested checks are redundant",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L272,74
validation-182,Plot Occupancy Manipulation,,Invalid PoC,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L131,76
findings-3,Malicious users can stake their NFT in the LandManager contract without paying landlord tax,,"While Landlords' first locking of funds, updatePlotMetadata() will be called to init tax rate, please refer:
https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/AccountManager.sol#L154 and 
https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LockManager.sol#L341
otherwise, there will be no valid plots to stake due to zero value locked",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L146,77
validation-90,`LandManager::stakeMunchable` does not check if a particular munchable tokenId has been staked previously.,,"a staked tokenId has already be held in LandManager contract, it can not be staked again",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L131,82
validation-256,Unbounded Loop Vulnerability,,the length is limited while staking,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L232-L310,87
validation-151,Incorrect `plotId` Validation Prevents Valid Staking,,the check here is correct,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L232-L310,87
validation-145,Every time a user uses the `unstakeMunchable` function he loses possession of his Munchable he just unstaked,,"munchNFT.transferFrom(address(this), mainAccount, tokenId)",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L192,87
findings-47,Zero Tax Rate Exploit in stakeMunchable Function,,"While Landlords' first locking of funds, updatePlotMetadata() will be called to init tax rate, please refer:
https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/AccountManager.sol#L154 and 
https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LockManager.sol#L341
otherwise, there will be no valid plots to stake due to zero value locked",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L146,91
validation-95,Denial of Service in `_removeTokenIdFromStakedList` function,,"The existance of removing tokenId is ensured by caller 
unstakeMunchable()",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L312,92
validation-255,Reentrancy Risk Vulnerability,,munchNFT.transferFrom() has no reentrancy risk,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L152,93
validation-383,Using memory instead of storage for toilerState in transferToUnoccupiedPlot() and unstakeMunchable() can lead to issues ,,storage for toilerState is used for writing,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L204,94
validation-247,Continuous Plot Hopping for Attribute Farming,,PoC is invalid,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L41,94
validation-176,Incorrect `lastToilDate` Handling Leads to Calculation Errors in `_farmPlots`,,toilerState[tokenId].lastToilDate is updated in the forceFarmPlots modifier of transferToUnoccupiedPlot(),Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L199-L226,97
validation-262,Timestamp Dependence Vulnerability,,Insufficient proof,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L232-L310,103
validation-57,Missing Reentrancy Protection,,munchNFT.transferFrom() has no reentrancy risk,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L135,105
validation-387,Non-triggeredPlotMetadata can be used for zero tax available plots,,"While Landlords' first locking of funds, updatePlotMetadata() will be called to init tax rate, please refer:
https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/AccountManager.sol#L154 and 
https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LockManager.sol#L341
otherwise, there will be no valid plots to stake due to zero value locked",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L137-L144,106
validation-181,Main account owners cannot stake munchables owned by sub-accounts,,"Not an issue, as subAccount can simply send munchNFT to mainAccount before staking",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L142,107
validation-118,Reentrancy Vulnerability in stakeMunchable Function,,munchNFT.transferFrom() has no reentrancy risk,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L152,118
validation-156,Unchecked Array Indexing in farmPlots Function,,"while staked.length == 0, the for loop would not be accessed",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L247,119
validation-263,Insufficient Access Control,,Insufficient proof,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L92-L101,123
findings-64,Missing validation in `stakeMunchable` allows stakers to not pay any taxes to landlords,,"While Landlords' first locking of funds, updatePlotMetadata() will be called to init tax rate, please refer:
https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/AccountManager.sol#L154 and 
https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LockManager.sol#L341
otherwise, there will be no valid plots to stake due to zero value locked",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L146,125
validation-226,The same user with different accounts can be `landlord` and `renter` which allows `mainAccount(renter)` to get higher rewards always. ,,"Not an issue, it's fair for usesr to get whole rewards if they stake munchNFT and also lock stable/ETH funds",Unsatisfactory,"https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L131,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L288,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L296",137
validation-311,Front-Running Vulnerability in Tax Rate Updates,,"Users can only update their own tax rate, the described frontrunning attack is meaningless",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L92-L101,142
validation-17,Munchables can be staked with 0% Tax rate,,"While Landlords' first locking of funds, updatePlotMetadata() will be called to init tax rate, please refer:
https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/AccountManager.sol#L154 and 
https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LockManager.sol#L341
otherwise, there will be no valid plots to stake due to zero value locked",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L146,143
findings-10,Renters can stake NFTs on unsuspecting landlord's plots allowing them to earn schnibbles while the landlords do not,,"While Landlords' first locking of funds, updatePlotMetadata() will be called to init tax rate, please refer:
https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/AccountManager.sol#L154 and 
https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LockManager.sol#L341
otherwise, there will be no valid plots to stake due to zero value locked",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L146,147
validation-26,`stakeMunchable` is allowing to stake against `plot which doesn't have metadata` which will prevent the landlord from earning his tax,,"While Landlords' first locking of funds, updatePlotMetadata() will be called to init tax rate, please refer:
https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/AccountManager.sol#L154 and 
https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LockManager.sol#L341
otherwise, there will be no valid plots to stake due to zero value locked",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L146,148
validation-269,Precision Loss ,,negligible rounding error,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L228-L289,157
validation-160,"Misuse of Valid PlotId in `unstakeMunchable`,`stakeMunchable`, `transferToUnoccupiedPlot` and `_farmPlots` functions",,plotOccupied[landlord][plotId].occupied is used to indentify if a plotId occupied or not,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L187,168
validation-343,Bypass of maximum staked munchables limit by transfering excess NFTs,,"checks based on address level is enough, it is not realistic and no need to limit based on real human",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L140,171
validation-314,No check for ```plotMetadata[landlord].lastUpdated == 0``` in ```stakeMunchable()``` function,,"While Landlords' first locking of funds, updatePlotMetadata() will be called to init tax rate, please refer:
https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/AccountManager.sol#L154 and 
https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LockManager.sol#L341
otherwise, there will be no valid plots to stake due to zero value locked",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L146,187
validation-35,Griefing Attack via Excessive Plot Transfers. ,,insufficient proof,Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/main/src/managers/LandManager.sol#L199,209
findings-30,Users can farm on zero-tax land if the landlord locked tokens before the LandManager deployment,,"While Landlords' first locking of funds, updatePlotMetadata() will be called to init tax rate, please refer:
https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/AccountManager.sol#L154 and 
https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LockManager.sol#L341
otherwise, there will be no valid plots to stake due to zero value locked",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L146,231
findings-6,User can stake into plot before landlord updates tax rate,,"While Landlords' first locking of funds, updatePlotMetadata() will be called to init tax rate, please refer:
https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/AccountManager.sol#L154 and 
https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LockManager.sol#L341
otherwise, there will be no valid plots to stake due to zero value locked",Unsatisfactory,https://github.com/code-423n4/2024-07-munchables/blob/94cf468aaabf526b7a8319f7eba34014ccebe7b9/src/managers/LandManager.sol#L146,253